\documentclass[a4paper,14pt]{extarticle}
% Стандартные формульные пакеты
\usepackage{float,amsmath,esint,amsfonts,wrapfig,bbm,bbold}
\usepackage{indentfirst}
\usepackage[usenames]{color}
\usepackage{multirow}
%выставляем поля
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
% Русский текст в формулах
\usepackage{mathtext}
% Подключение русского языка
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}
\usepackage[utf8]{inputenc}
% Рисунки
\usepackage{graphicx,caption,subcaption}
% Landscape page
\usepackage{lscape}
\renewcommand{\arraystretch}{1.1}

\begin{document}

Представим базис в виде:
$$ \chi = R( r - \vec{R} ) A( \theta_A, \varphi_A ) $$
$$ R(r) = \sum_{i=1}^n C_i e^{ -\alpha_i r^2 } $$

\begin{equation*}
 A_{lm} = \begin{cases} Y_{lm} r^l \\
		      (Y_{lm} + Y_{lm})r^l \\
		      (Y_{lm} - Y_{lm})r^l/i \\
		       x^k y^p z^q\ ( k + p + q = l ) \\
		       \end{cases}
\end{equation*}
$$ l = 1: A_0 = C_0 $$
$$ l = 1: A_1 = \{ C_1x,\ C_1y,\ C_1z \}$$
$$ l = 2: A_1 = \{ C_2xy,\ C_2xz,\ C_3yz,\ C_3x^2,\ C_3y^2,\ C_3z^2 \}$$
Но эти же функции мы можем переписать в виде:
$$ l = 2: A_1' = \{ C_2xy,\ C_2xz,\ C_3yz,\ C_3 ( x^2 - y^2 ),\ C_3( 2z^2 - x^2 - y^2 ) \}$$
$$ C_3 ( x^2 + y^2 + z^2 ) = C_3 r^2 \sim r^2 = Y_{00} $$

Таким образом, получили "загрязнение" базиса функциями более низкого порядка --- контаминантами.

При $ l = 3 $ имеем 10 функций, опять же имеется загрязнение вида: $( x^2 + y^2 + z^2 ) = r^2$.

Когда мы говорим о базисном наборе, мы должны иметь в виду несколько понятий:
\begin{enumerate}

\item контаминанта --- функция, загрязняющая $l$ оболочку функциями с $l' < l$.

\item диффузная функция --- функция с очень малым множителем в показателе экспоненты:
$ \alpha \rightarrow 0 \ \text{ имеем сильно размытый гаусс. }$ \\ 
Нужны для описания анионов или систем с сильно "распухшей" электронной оболочкой.
Сродство к электрону:
в квантовомеханических рассчетах оно может быть только отрицательно ($E(A^{\ominus}) - E(A) < 0$),
в противном случае рассчет должен дать не анион, а молекулу плюс электрон --- такое поведение свидетельствует о том, 
что выбран неправильный базис (нужны диффузные функции).

\item поляризационная функция --- нужна для описания валентных оболочек:
Представим атом водорода в молекуле; 
под действием полей других атомов валентная $s$ орбиталь поляризуется и преобретает симметрию (шар$\rightarrow$ эллипс).
Тогда для описания поляризованной функции нужны базисные функции с большим $l$:
$$s (valence) \rightarrow p (polarization)$$
$$p (valence) \rightarrow d (polarization)$$
$$d (valence) \rightarrow f (polarization)$$
Иногда можно использовать в больших молекулах вместо диффузных функции поляризационные функции соседей.
Валентное расщепление базисного набора --- число линейно независимых функций с данным значением $l$:\\
Дважды расщепленные --- cc-pv$\underline{\text{DZ}},\ 6-\underline{31}$G\\
Трижды расщепленные --- cc-pv$\underline{\text{TZ}},\ 6-\underline{311}$G\\
сс --- корреляционно согласованные --- много одинаковых базисных функций
$$\chi_1 = \sum_{i=1} ^ N C_i e^{-\alpha_i r^2}$$
$$\chi_2 = \sum_{i=1} ^ N C_i' e^{-\alpha_i r^2}$$
$$\langle\chi_1|A|\chi_2\rangle = \sum_i\sum_j C_iC_j'\langle e^{-\alpha_i r^2}|A|e^{-\alpha_jr^2}\rangle$$

Получается, что все средние значения сводятся к вычислению гауссовых примитивов. 
Тогда можем посчитать интегралы на одних и тех же функциях один раз, а потом просто суммировать.

cc-pvDZ углерода = 3(количество)s, 2p, 1d\\
cc-pvQZ водорода = 4s, 3p, 2d, 1f\\
aug-cc-pvDZ углерода = 3s + 1s, 2p + 1p, 1d + 1d (расширенный)\\
d-aug-cc-pvTZ водорода = 3s + 2s, 2p + 2p, 1d + 2d (дважды расширенный)\\
(9s,4p,1d)/[3s,2p,1d] = cc-pvDZ --- 9 разных гауссовых примитивов собраны в 3 s--функций, 4 --- в 2 p, 1 --- в одну d.

$$ \chi = \sum_{i=1}^N C_iN_ie^{-\alpha_i r^2} $$
где $C_i$ --- коэффициенты контрактации при нормированных примитивах (из файла базиса), $N_i$ --- нормировка примитива:
$$1 = N_i^2\int_{-\infty}^{+\infty} e^{-2\alpha_i r^2} dxdydz = N_i^2 \int_0^{2\pi}\int_0^{\pi}\int_0^{+\infty} e^{-2\alpha_i r^2} r^2\sin\theta\,drd\theta d\varphi = $$
$$ = 2\pi N_i^2 \int_0^{+\infty} e^{-2\alpha_i r^2} r^2\,dr = \pi N_i^2 \int_{-\infty}^{+\infty} e^{-2\alpha_i r^2} r^2\,dr = $$
$$ = -\frac{\pi}{2} N_i^2\frac{\partial}{\partial \alpha_i} \int_{-\infty}^{+\infty} e^{-2\alpha_i r^2} \,dr = %
     -\frac{\pi}{2} N_i^2\frac{\partial}{\partial \alpha_i} \frac{1}{\sqrt{2\alpha_i}}\int_{\-infty}^{\infty} e^{-( r\sqrt{ 2\alpha_i} )^2} \,dr\sqrt{2\alpha} = $$
$$ = -\frac{\pi}{2}N_i^2\frac{\partial}{\partial \alpha_i} \sqrt{\frac{\pi}{2\alpha_i}} = \frac{N_i^2}{2}\left(\frac{\pi}{2\alpha}\right)^{3/2}$$
$$N_i^2 = 2\left(\frac{2\alpha_i}{\pi}\right)^{3/2},\ N_i = \sqrt{2 \left(\frac{2\alpha_i}{\pi}\right)^{3/2}}$$
\item комбинация s, p$_{\text{x}}$, p$_{\text{y}}$, p$_{\text{z}}$ 
с одинаковыми экспонентами, но разными коэффициентами контрактации --- L функция.
В файле базисов состоит из трех колонок --- показатель экспоненты, 
коэффициенты контрактации для s функции, 
коэффициенты контрактации для p функции. Можно чуть быстрее считать двухэлектронные интегралы.

\item optimized general:\\
Вариационная задача имеет вид:

\begin{equation*}
\begin{cases}
g_1 = C_1f_1 + C_2f_2 + C_3f_3 + C_4f_4 \\
g_2 = C_1'f_1 + C_2'f_2 + C_3'f_3 + C_4'f_4 \\
g_3 = f_4 \\
\end{cases}
\end{equation*}

Но тогда можно последнюю функцию выкинуть из первых двух, перенормировать базис и разбить задачу на два куска.

\end{enumerate}

Этапы работы с файлом:

\begin{enumerate}
\item считать базисный набор из файла;
\item явно добавить угловую зависимость;
\item пересчитать коэффициенты контрактации с учетом нормировок примитивов;
\item перенормировать базисную функцию.
\end{enumerate}

Дальше занимаемся приложением такого базиса к файлу с геометриями.

\end{document}
